<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for production/redux/modules/auth.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">All files</a> / <a href="index.html">production/redux/modules</a> auth.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">70.71% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>70/99</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">69.09% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>38/55</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">50% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>12/24</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">71.13% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>69/97</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DEFAULT_STATE = undefined;
&nbsp;
var _typeof = typeof Symbol === "function" &amp;&amp; typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : <span class="fstat-no" title="function not covered" ><span class="branch-1 cbranch-no" title="branch not covered" >fu</span>nction (obj) { <span class="cstat-no" title="statement not covered" >return obj &amp;&amp; typeof Symbol === "function" &amp;&amp; obj.constructor === Symbol &amp;&amp; obj !== Symbol.prototype ? "symbol" : typeof obj; </span>};</span> /* global localStorage */
&nbsp;
exports.setCurrentUser = setCurrentUser;
exports.userLoading = userLoading;
exports.setErrors = setErrors;
exports.setClientIp = setClientIp;
exports.login = login;
exports.logout = logout;
exports.getClientIp = getClientIp;
exports.default = user;
exports.handleLoginResponse = handleLoginResponse;
exports.prepareUserFromToken = prepareUserFromToken;
&nbsp;
var _axios = require('axios');
&nbsp;
var _axios2 = _interopRequireDefault(_axios);
&nbsp;
var _jsonwebtoken = require('jsonwebtoken');
&nbsp;
var _jsonwebtoken2 = _interopRequireDefault(_jsonwebtoken);
&nbsp;
var _setAuthorizationToken = require('../../auth/setAuthorizationToken');
&nbsp;
var _setAuthorizationToken2 = _interopRequireDefault(_setAuthorizationToken);
&nbsp;
function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? <span class="branch-0 cbranch-no" title="branch not covered" >obj </span>: { default: obj }; }
&nbsp;
// ******* Actions *******
&nbsp;
var SET_CURRENT_USER = 'SET_CURRENT_USER';
var USER_LOADING = 'USER_LOADING';
var SET_CLIENT_IP = 'SET_CLIENT_IP';
var SET_ERRORS = 'SET_ERRORS';
&nbsp;
// ******* Action Creators *******
&nbsp;
/**
 * Sets state.user, and eventually state.isAuthenticated and state.userLoading
 * in its reducer.
 *
 * @param {object} user - A decoded jwt, or an error object
 *
 * The token object being set to user will contain a newly authenitcated
 * user's id string and username string, as well as the token's timestamp as iat.
 * example: { id: '12341234asdfasdf', username: 'PollKilla', iat: '1324567894'}
 */
function setCurrentUser() {
  var user = arguments.length &gt; 0 &amp;&amp; arguments[0] !== undefined ? arguments[0] : <span class="branch-1 cbranch-no" title="branch not covered" >{};</span>
&nbsp;
  return {
    type: SET_CURRENT_USER,
    user: user
  };
}
/**
 * Sets state.userLoading
 *
 * @param {boolean} bool
 */
function userLoading(bool) {
  return {
    type: USER_LOADING,
    userLoading: bool
  };
}
/**
 * Sets state.errors
 *
 * @param {object} errors - should contain a form error or server error
 * example: { form: 'Invalid Credentials' } or { server: 'Server error. Try agian in a moment.' }
 */
function setErrors() {
  var errors = arguments.length &gt; 0 &amp;&amp; arguments[0] !== undefined ? arguments[0] : <span class="branch-1 cbranch-no" title="branch not covered" >{};</span>
&nbsp;
  return {
    type: SET_ERRORS,
    errors: errors,
    userLoading: false
  };
}
/**
 * Sets state.clientIp
 *
 * @param {string} clientIp - The client's IP address as a string received from the server.
 */
function setClientIp(clientIp) {
  return {
    type: SET_CLIENT_IP,
    clientIp: clientIp
  };
}
/**
 * Attempts to authenticate a user on the server.
 *
 * @param {object} data - An object containing an identifier and password to login with.
 * example: { identifier: 'TracyJordan', password: 'IAMMYOWNPASSWORD'}
 *
 * The response from /api/auth will be:
 * res.data.errors - errors object: { errors: { form: 'Invalid Credentials' } }
 * or
 * res.data.token - token object: { id: '12341234asdfasdf', username: 'PollKilla', iat: '1324567894'}
 */
function <span class="fstat-no" title="function not covered" >login(</span>data) {
<span class="cstat-no" title="statement not covered" >  return <span class="fstat-no" title="function not covered" >fu</span>nction (dispatch) {</span>
<span class="cstat-no" title="statement not covered" >    dispatch(userLoading(true));</span>
<span class="cstat-no" title="statement not covered" >    _axios2.default.post('/api/auth', data).then(<span class="fstat-no" title="function not covered" >fu</span>nction (res) {</span>
<span class="cstat-no" title="statement not covered" >      return handleLoginResponse(res, dispatch, prepareUserFromToken);</span>
    }).catch(<span class="fstat-no" title="function not covered" >fu</span>nction (err) {
<span class="cstat-no" title="statement not covered" >      dispatch(userLoading(false));</span>
<span class="cstat-no" title="statement not covered" >      console.error('ERROR: redux: login request returned a server error:', err);</span>
<span class="cstat-no" title="statement not covered" >      return dispatch(setErrors({ server: 'Server error. Try agian in a moment.' }));</span>
    });
  };
}
/**
 * Removes a user's jwt from localstorage and client headers, and clears user state in redux
 */
function <span class="fstat-no" title="function not covered" >logout(</span>) {
<span class="cstat-no" title="statement not covered" >  return <span class="fstat-no" title="function not covered" >fu</span>nction (dispatch) {</span>
<span class="cstat-no" title="statement not covered" >    localStorage.removeItem('jwtToken');</span>
<span class="cstat-no" title="statement not covered" >    (0, _setAuthorizationToken2.default)(false);</span>
<span class="cstat-no" title="statement not covered" >    dispatch(setCurrentUser({}));</span>
  };
}
/**
 * Retrieves the client's IP address from the server
 */
function <span class="fstat-no" title="function not covered" >getClientIp(</span>) {
<span class="cstat-no" title="statement not covered" >  return <span class="fstat-no" title="function not covered" >fu</span>nction (dispatch) {</span>
<span class="cstat-no" title="statement not covered" >    _axios2.default.get('/api/auth/ip').then(<span class="fstat-no" title="function not covered" >fu</span>nction (res) {</span>
<span class="cstat-no" title="statement not covered" >      dispatch(setClientIp(res.data.clientIp));</span>
    }).catch(<span class="fstat-no" title="function not covered" >fu</span>nction (err) {
<span class="cstat-no" title="statement not covered" >      console.error('ERROR: redux: failed to receive current client ip address from the server', err);</span>
    });
  };
}
&nbsp;
// ******* Reducers *******
&nbsp;
/**
 * Sets the user object as action.user if defined and valid, of null
 * if the user object is empty or invalid. state.isAuthenticated defaults to false,
 * but gets set to true if the user object is valid. state.userLoading gets set to false
 * regardless.
 */
var setCurrentUserReducer = function setCurrentUserReducer(state, action) {
  var authenticationStatus = false;
  var user = action.user;
  if (user &amp;&amp; user.username) {
    authenticationStatus = true;
  } else {
    user = null;
  }
  return Object.assign({}, state, {
    isAuthenticated: authenticationStatus,
    user: user,
    userLoading: false
  });
};
&nbsp;
var userLoadingReducer = function userLoadingReducer(state, action) {
  if (typeof action.userLoading !== 'boolean') {
    console.error('ERROR: redux: userLoading was not passed a boolean:', action.userLoading);
    return Object.assign({}, state, { userLoading: false });
  }
  return Object.assign({}, state, { userLoading: action.userLoading });
};
&nbsp;
var setClientIpReducer = function setClientIpReducer(state, action) {
  return Object.assign({}, state, { clientIp: action.clientIp });
};
&nbsp;
/**
 * Sets state.errors with a form error or a server error. If any other error is offered,
 * something is wrong.
 */
var setErrorsReducer = function setErrorsReducer(state, action) {
  if (_typeof(action.errors) !== 'object') {
    return Object.assign({}, state);
  }
  <span class="missing-if-branch" title="if path not taken" >I</span>if (!action.errors.form &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >!action.errors.server)</span> {
<span class="cstat-no" title="statement not covered" >    console.error('ERROR: redux: Unknown error key passed in error object to setErrors:', action.errors);</span>
  }
  return Object.assign({}, state, { errors: action.errors });
};
&nbsp;
// ******* Root Reducer Slice *******
&nbsp;
var DEFAULT_STATE = exports.DEFAULT_STATE = {
  isAuthenticated: null,
  user: null,
  errors: null,
  userLoading: false,
  clientIp: null
};
function user() {
  var state = arguments.length &gt; 0 &amp;&amp; arguments[0] !== undefined ? arguments[0] : DEFAULT_STATE;
  var action = arguments[1];
&nbsp;
  switch (action.type) {
    case SET_CURRENT_USER:
      return setCurrentUserReducer(state, action);
    case USER_LOADING:
      return userLoadingReducer(state, action);
    case SET_CLIENT_IP:
      return setClientIpReducer(state, action);
    case SET_ERRORS:
      return setErrorsReducer(state, action);
    default:
      return state;
  }
}
&nbsp;
// ************** Lib **************
&nbsp;
/**
 * After a login attempt to '/api/auth' with the client's credentials,
 * the response from the server gets handled here. If the login attempt is
 * successful, a token will be in the response as res.data.token. If the user's
 * username/email and password not correct, an error object will be in the
 * respose as res.data.errors.form. If no token or errors object come with the
 * response, something went wrong on the server, and a server error will be passed
 * along
 *
 * @param {object} res - Either res.data.errors or res.data.token should be defined
 * @param {function} dispatch - Redux's dispatch function in this function's calling context
 * @param {function} prepareUser - Alias for prepareUserFromToken. The name change is to
 * fix a name collision in testing.
 */
function handleLoginResponse(res, dispatch, prepareUser) {
  console.log('auth.js: res.data:', res.data);
  if (!res.data) {
    dispatch(userLoading(false));
    console.error('res.data not present from \'/api/auth\' :', res);
    return dispatch(setErrors({ server: 'Server Error. Bad response.' }));
  }
  // handle unsuccessful login
  if (res.data.errors) {
    // res.data will contain { errors: { form: 'Invalid Credentials' } }
    return dispatch(setErrors(res.data.errors));
  }
  // handle token on successful login
  var user = prepareUser(res);
  <span class="missing-if-branch" title="else path not taken" >E</span>if (user &amp;&amp; user.username) {
    dispatch(setCurrentUser(user));
    return dispatch(userLoading(false));
  }
  // if the server responds but res.data.errors and res.data.token are not defined, handle it here.
  // This should never get reached.
<span class="cstat-no" title="statement not covered" >  dispatch(userLoading(false));</span>
<span class="cstat-no" title="statement not covered" >  console.error('ERROR: redux: no errors or token offered from \'/api/auth\' :', res);</span>
<span class="cstat-no" title="statement not covered" >  return dispatch(setErrors({ server: 'no errors or token returned' }));</span>
}
&nbsp;
/**
 * Prepares the user object by decoding a valid JSON web token. This also
 * sets the token in localStorage and the client's headers through setAuthorizationToken.
 * These side effects hindered this function's testability to the point where
 * mocking localStorage, jwt, and setAuthorizationToken would require tight coupling with handleLoginResponse and
 * up to the login action creator, so I opted out of testing this function to keep the flow clear and simple.
 * This function isn't doing much.
 *
 * @param {object} res - The response object from Express. res.data.token should
 * be defined at this point, otherwise its an error.
 *
 * @returns {object} user - Decoded token such as: { id: '12341234asdfasdf', username: 'PollKilla', iat: '1324567894'}
 * @returns {null} null - If a token isn't found in the response object, something went wrong.
 */
function <span class="fstat-no" title="function not covered" >prepareUserFromToken(</span>res) {
<span class="cstat-no" title="statement not covered" >  console.log('prepareUserFromToken res:', res);</span>
  var token = <span class="cstat-no" title="statement not covered" >res.data.token ? res.data.token : null;</span>
<span class="cstat-no" title="statement not covered" >  if (token) {</span>
<span class="cstat-no" title="statement not covered" >    localStorage.setItem('jwtToken', token);</span>
<span class="cstat-no" title="statement not covered" >    (0, _setAuthorizationToken2.default)(token);</span>
    var _user = <span class="cstat-no" title="statement not covered" >_jsonwebtoken2.default.decode(token);</span>
<span class="cstat-no" title="statement not covered" >    return _user;</span>
  } else {
<span class="cstat-no" title="statement not covered" >    console.error('ERROR: redux: prepareUserFromToken did not receive a token', res);</span>
<span class="cstat-no" title="statement not covered" >    return null;</span>
  }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Mar 12 2017 18:29:56 GMT-0500 (CDT)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
